{% extends 'admin/master.html' %}

{% block head %}
  {{ super() }}
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
  />
  <style>
    #map { height: 80vh; width: 100%; }
  </style>
{% endblock %}

{% block body %}
<div class="container-fluid mt-4">
  <h2>Карта локаций</h2>
  <div id="map"></div>
</div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
  <script>
    const locations = {{ locations|tojson }};
    const map = L.map('map').setView([55.75, 37.61], 10);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap'
    }).addTo(map);

    locations.forEach(loc => {
      const [id, name, lat, lon] = loc;
      L.marker([lat, lon]).addTo(map)
        .bindPopup(`<b>${name}</b><br>ID: ${id}`);
    });
  </script>
{% endblock %}
